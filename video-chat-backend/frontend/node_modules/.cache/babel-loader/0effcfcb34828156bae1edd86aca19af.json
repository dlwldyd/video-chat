{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/dlwld/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/dlwld/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _taggedTemplateLiteral from\"C:/Users/dlwld/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import axios from\"axios\";import{useEffect}from\"react\";import{useNavigate}from\"react-router\";import{useSetRecoilState}from\"recoil\";import styled from\"styled-components\";import myData from\"../data/data\";import handleAxiosException from\"../exception/handleAxiosException\";import{loginStateAtom,nicknameAtom,usernameAtom}from\"./state\";import{jsx as _jsx}from\"react/jsx-runtime\";var Box=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    width: 100%;\\n    height: 98vh;\\n    display: flex;\\n    justify-content: center;\\n    align-items: center;\\n\"])));var Loading=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    font-size: 100px;\\n    font-family: \",\";;\\n\"])),function(props){return props.theme.font;});function FetchMemberInfo(){var navigate=useNavigate();var setLoginState=useSetRecoilState(loginStateAtom);var setUsername=useSetRecoilState(usernameAtom);var setNickname=useSetRecoilState(nicknameAtom);// 서버로부터 사용자 로그인 정보를 가져와서 세션 스토리지에 저장한다.\nuseEffect(function(){var getMemberInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"\".concat(myData.domain,\"/api/memberInfo\"),{withCredentials:true});case 2:_context.next=4;return _context.sent.data;case 4:json=_context.sent;// sessionStorage.setItem(\"authenticated\", json.authenticated);\nsetLoginState(function(loginState){return true;});if(json.authenticated){// sessionStorage.setItem(\"username\", json.username);\n// sessionStorage.setItem(\"nickname\", json.nickname);\nsetUsername(function(username){return json.username;});setNickname(function(nickname){return json.nickname;});}navigate(\"/\",{replace:true});case 8:case\"end\":return _context.stop();}}},_callee);}));return function getMemberInfo(){return _ref.apply(this,arguments);};}();try{getMemberInfo();}catch(err){handleAxiosException(err);}},[navigate]);return/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(Loading,{children:\"\\uB85C\\uADF8\\uC778 \\uC911..\"})});}export default FetchMemberInfo;","map":{"version":3,"names":["axios","useEffect","useNavigate","useSetRecoilState","styled","myData","handleAxiosException","loginStateAtom","nicknameAtom","usernameAtom","Box","div","Loading","props","theme","font","FetchMemberInfo","navigate","setLoginState","setUsername","setNickname","getMemberInfo","get","domain","withCredentials","data","json","loginState","authenticated","username","nickname","replace","err"],"sources":["C:/project/video_chat/video-chat-backend/frontend/src/Auth/FetchMemberInfo.tsx"],"sourcesContent":["import axios, { AxiosError } from \"axios\";\nimport { useEffect } from \"react\";\nimport { useNavigate } from \"react-router\";\nimport { useSetRecoilState } from \"recoil\";\nimport styled from \"styled-components\";\nimport myData from \"../data/data\";\nimport handleAxiosException from \"../exception/handleAxiosException\";\nimport { loginStateAtom, nicknameAtom, usernameAtom } from \"./state\";\n\nconst Box = styled.div`\n    width: 100%;\n    height: 98vh;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`\n\nconst Loading = styled.div`\n    font-size: 100px;\n    font-family: ${props => props.theme.font};;\n`\n\nfunction FetchMemberInfo() {\n\n    const navigate = useNavigate();\n\n    const setLoginState = useSetRecoilState(loginStateAtom);\n    \n    const setUsername = useSetRecoilState(usernameAtom);\n\n    const setNickname = useSetRecoilState(nicknameAtom);\n\n    // 서버로부터 사용자 로그인 정보를 가져와서 세션 스토리지에 저장한다.\n    useEffect(() => {\n        const getMemberInfo = async () => {\n            const json = await (await axios.get(`${myData.domain}/api/memberInfo`, {\n                withCredentials: true\n            })).data;\n            // sessionStorage.setItem(\"authenticated\", json.authenticated);\n            setLoginState(loginState => true);\n            if(json.authenticated) {\n                // sessionStorage.setItem(\"username\", json.username);\n                // sessionStorage.setItem(\"nickname\", json.nickname);\n                setUsername(username => json.username);\n                setNickname(nickname => json.nickname);\n            }\n            navigate(\"/\", {replace: true});\n        }\n        try {\n            getMemberInfo();\n        } catch(err: unknown | AxiosError) {\n            handleAxiosException(err);\n        }\n    }, [navigate]);\n\n    return (\n        <Box>\n            <Loading>로그인 중..</Loading>\n        </Box>\n    )\n}\nexport default FetchMemberInfo;"],"mappings":"8fAAA,MAAOA,MAAP,KAAkC,OAAlC,CACA,OAASC,SAAT,KAA0B,OAA1B,CACA,OAASC,WAAT,KAA4B,cAA5B,CACA,OAASC,iBAAT,KAAkC,QAAlC,CACA,MAAOC,OAAP,KAAmB,mBAAnB,CACA,MAAOC,OAAP,KAAmB,cAAnB,CACA,MAAOC,qBAAP,KAAiC,mCAAjC,CACA,OAASC,cAAT,CAAyBC,YAAzB,CAAuCC,YAAvC,KAA2D,SAA3D,C,2CAEA,GAAMC,IAAG,CAAGN,MAAM,CAACO,GAAV,oLAAT,CAQA,GAAMC,QAAO,CAAGR,MAAM,CAACO,GAAV,oHAEM,SAAAE,KAAK,QAAIA,MAAK,CAACC,KAAN,CAAYC,IAAhB,EAFX,CAAb,CAKA,QAASC,gBAAT,EAA2B,CAEvB,GAAMC,SAAQ,CAAGf,WAAW,EAA5B,CAEA,GAAMgB,cAAa,CAAGf,iBAAiB,CAACI,cAAD,CAAvC,CAEA,GAAMY,YAAW,CAAGhB,iBAAiB,CAACM,YAAD,CAArC,CAEA,GAAMW,YAAW,CAAGjB,iBAAiB,CAACK,YAAD,CAArC,CAEA;AACAP,SAAS,CAAC,UAAM,CACZ,GAAMoB,cAAa,4FAAG,oKACQrB,MAAK,CAACsB,GAAN,WAAajB,MAAM,CAACkB,MAApB,oBAA6C,CACnEC,eAAe,CAAE,IADkD,CAA7C,CADR,6CAGdC,IAHc,QACZC,IADY,eAIlB;AACAR,aAAa,CAAC,SAAAS,UAAU,QAAI,KAAJ,EAAX,CAAb,CACA,GAAGD,IAAI,CAACE,aAAR,CAAuB,CACnB;AACA;AACAT,WAAW,CAAC,SAAAU,QAAQ,QAAIH,KAAI,CAACG,QAAT,EAAT,CAAX,CACAT,WAAW,CAAC,SAAAU,QAAQ,QAAIJ,KAAI,CAACI,QAAT,EAAT,CAAX,CACH,CACDb,QAAQ,CAAC,GAAD,CAAM,CAACc,OAAO,CAAE,IAAV,CAAN,CAAR,CAZkB,sDAAH,kBAAbV,cAAa,0CAAnB,CAcA,GAAI,CACAA,aAAa,GAChB,CAAC,MAAMW,GAAN,CAAiC,CAC/B1B,oBAAoB,CAAC0B,GAAD,CAApB,CACH,CACJ,CApBQ,CAoBN,CAACf,QAAD,CApBM,CAAT,CAsBA,mBACI,KAAC,GAAD,wBACI,KAAC,OAAD,0CADJ,EADJ,CAKH,CACD,cAAeD,gBAAf"},"metadata":{},"sourceType":"module"}